-- -----------------------------------------------------
-- Table filmes
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS filmes (
  id SERIAL NOT NULL,
  titulo VARCHAR(60) NOT NULL,
  orcamento INT NULL,
  homepage VARCHAR(70) NOT NULL,
  idioma_original VARCHAR(45) NOT NULL,
  descricao TEXT NULL,
  popularidade DECIMAL (10,2) NOT NULL,
  data_lancamento TIMESTAMP NOT NULL,
  receita INT NOT NULL,
  duracao INT NOT NULL,
  status VARCHAR(45) NOT NULL,
  slogan VARCHAR(100) NULL,
  media_avaliacoes DECIMAL (10,2) NOT NULL,
  total_avaliacoes INT NOT NULL,
  PRIMARY KEY (id)
  );

-- -----------------------------------------------------
-- Table generos
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS generos (
  id SERIAL NOT NULL,
  nome VARCHAR(100) NOT NULL,
  PRIMARY KEY (id)
  );

-- -----------------------------------------------------
-- Table generos_filmes
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS generos_filmes (
    KEY fkg (generos_id),
    KEY fkf (filmes_id),
  );
  
ALTER TABLE ADD CONSTRAINT fkg FOREIGN KEY (generos_id) REFERENCES generos (id);

ALTER TABLE ADD CONSTRAINT fkf FOREIGN KEY (filmes_id) REFERENCES filmes (id);    

-- -----------------------------------------------------
-- Table atores
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS generos (
  id SERIAL NOT NULL,
  nome VARCHAR(100) NOT NULL,
  genero INT NOT NULL,
  PRIMARY KEY (id)
  );

-- -----------------------------------------------------
-- Table elencos
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS elencos (
    KEY fka (atores_id),
    KEY fkf (filmes_id),
  );
  
ALTER TABLE ADD CONSTRAINT fka FOREIGN KEY (atores_id) REFERENCES atores (id);

-- -----------------------------------------------------
-- Table keywords
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS keywords (
  id SERIAL NOT NULL,
  nome VARCHAR(100) NOT NULL,
  PRIMARY KEY (id)
  );

-- -----------------------------------------------------
-- Table keywords_filmes
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS keywords_filmes (
    KEY fkk (keywords_id),
    KEY fkf (filmes_id),
  );
  
ALTER TABLE ADD CONSTRAINT fkk FOREIGN KEY (keywords_id) REFERENCES keywords (id);  

-- -----------------------------------------------------
-- Table avaliacoes
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS avaliacoes (
  id SERIAL NOT NULL,
  nota DECIMAL (10,2) NOT NULL,
  filmes_id INT NOT NULL,
  PRIMARY KEY (id),
  CONSTRAINT fk_avaliacao_filme
    FOREIGN KEY (filmes_id)
    REFERENCES filmes (id)
  );
  
-- -----------------------------------------------------
-- Table paises
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS paises (
  id SERIAL NOT NULL,
  nome VARCHAR(80) NOT NULL,
  sigla VARCHAR(45) NOT NULL,
  PRIMARY KEY (id)
  );
  
-- -----------------------------------------------------
-- Table produtoras
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS produtoras (
  id SERIAL NOT NULL,
  nome VARCHAR(100) NOT NULL,
  PRIMARY KEY (id)
  CONSTRAINT fk_produtoras_paises
    FOREIGN KEY (paises_id)
    REFERENCES paises (id)
  );

-- -----------------------------------------------------
-- Table produtoras_filmes
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS produtoras_filmes (
    KEY fkp (produtoras_id),
    KEY fkf (filmes_id),
  );
  
ALTER TABLE ADD CONSTRAINT fkp FOREIGN KEY (produtoras_id) REFERENCES produtoras (id);  
  
-- -----------------------------------------------------
-- Table idiomas
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS idiomas (
  id SERIAL NOT NULL,
  nome VARCHAR(80) NOT NULL,
  sigla VARCHAR(45) NOT NULL,
  PRIMARY KEY (id)
  );

-- -----------------------------------------------------
-- Table filmes_idiomas
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS filmes_idiomas (
    KEY fki (idiomas_id),
    KEY fkf (filmes_id),
  );
  
ALTER TABLE ADD CONSTRAINT fki FOREIGN KEY (idiomas_id) REFERENCES idiomas (id);
